:javascript
  $(document).ready(function(){
  $("#permitSelect").change(function () {
      var int = "";
      $("#permitSelect option:selected").each(function () {
        pSelect = parseInt($(this).attr("value"));
      });
      if (pSelect > 0){
        $("#siteSelect option[value=0]").attr('disabled','disabled');
        // user not select a site yet
        if ($("#siteSelect option:selected").attr("value") == '0') {
          $("#siteSelect option[value=1]").attr('selected','selected');
        }  
      } else {
       $("#siteSelect option[value=0]").removeAttr("disabled").attr('selected','selected');
      }
  });
  });
#wrapper
  #content
  %h1.page_title 編輯帳號
  - if @user.nil?
    %form{:action => "/manager/edit", :method => "get"}
      .field
        %label.label{:for => "user_id"} 員工序號
        .ui
          %input{ :id => "user_id", :name => "user[id]", :size => 10, :type => "text", :value => ""}
      %br
      .field
        .ui
          %input{:name => "update", :value => "取得帳號", :type => "submit"}
  -else
    %form{:action => "/manager/edit", :method => "post"}
      .field
        %label.label{:for => "user_id"} 員工序號
        .ui
          %input{ :type => "hidden", :name => "user[id]", :value => @user.id}
          %input{ :id => "user_id", :name => "user[id]", :size => 10, :type => "text", :value => @user.id, :disabled => "disabled"}
      .field
        %label.label{:for => "user_name"} 員工姓名
        .ui
          %input{ :id => "user_name", :name => "user[name]", :size => 10, :type => "text", :value => @user.name, :disabled => "disabled"}
      .field
        %label.label{:for => "user_password"} 密碼
        .ui
          %input{ :id => "user_password", :name => "user[password]", :size => 10, :type => "password" }
      .field
        %label.label{:for => "user_password_confirmation"} 密碼確認
        .ui
          %input{ :id => "user_password_confirmation", :name => "user[password_confirmation]", :size => 10, :type => "password" }
      .field
        %label.label{:for => "user_site"} 所屬分站
        .ui
          %select{:id => "siteSelect", :name => "user[site]"}
            - if @current_user.permission_level == -1
              %option{:value => 0, :selected => @user.site_id.nil? ?true:false} - 總公司 -     
            - @sites.each do |site|
              - if @user.site != nil  
                %option{:value => site.id, :selected => @user.site.id-site.id==0} #{site.name}
          
      .field
        %label.label{:for => "user_permission_level"} 系統權限
        .ui
          %select{:id => "permitSelect", :name => "user[permission_level]"}
            - if @current_user.permission_level == -1
              %option{:value => -1, :selected => @user.permission_level==-1?true:false} 系統管理者
              %option{:value => 0, :selected => @user.permission_level==0?true:false} 總站主管
            - if @user.permission_level == 1   
              %option{:value => 1, :selected => @user.permission_level==1?true:false} 分站主管
            - if @user.permission_level > 1
              %option{:value => 2, :selected => @user.permission_level==2?true:false} 登錄人員 
      %br
      .field
        .collection
          %input{:name => "update", :value => "修改帳號", :type => "submit"}
          - if @current_user.permission_level < 2
            %input{:name => "delete", :value => "移除帳號", :type => "submit"}
          %input{:name => "cancel", :value => "取消", :type => "submit"}
#navigation
  %nav
    %ul
      %li
        %a.selected{:href => "/manager/edit"} 新增修改帳號
      - if @current_user.permission_level == -1
        %li
          %a{:href => "/manager/sitemgr"} 分站資訊維護